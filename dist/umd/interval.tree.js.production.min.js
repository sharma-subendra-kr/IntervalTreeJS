/** @license IntervalTreeJS

IntervalTreeJS, a JavaScript Binary Search Tree library that helps to query, insert and delete intervals in the binary search tree.

Copyright Â© 2019-2020 Subendra Kumar Sharma. All Rights reserved. (jobs.sharma.subendra.kr@gmail.com)

This file is part of IntervalTreeJS.

IntervalTreeJS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

IntervalTreeJS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with IntervalTreeJS.  If not, see <https://www.gnu.org/licenses/>.

Written by Subendra Kumar Sharma.

*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Stack"),require("Queue")):"function"==typeof define&&define.amd?define(["Stack","Queue"],e):"object"==typeof exports?exports.IntervalTreeJS=e(require("Stack"),require("Queue")):t.IntervalTreeJS=e(t.Stack,t.Queue)}(window,(function(t,e){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var l=e[r]={i:r,l:!1,exports:{}};return t[r].call(l.exports,l,l.exports,i),l.l=!0,l.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)i.d(r,l,function(e){return t[e]}.bind(null,l));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="assets",i(i.s=3)}([function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e,i){},function(t,e,i){"use strict";i.r(e),i.d(e,"IntervalTreesRecursive",(function(){return u})),i.d(e,"IntervalTreesIterative",(function(){return p}));var r=i(0),l=function(t,e){var i=t,l=new r.ArrayStack({initialSize:e});for(l.push(i);null!==i.left;)i=i.left,l.push(i);for(var n=i.interval.low,a=l.ptr,h=null,s=new Array(a+1),u=-1;a>=0&&l.stack[a].interval.low===n;)h=l.stack[a],a--,s[++u]=h;s.length=u+1,a>=0&&(null!==h.right?(l.stack[a].left=h.right,h.right=null):l.stack[a].left=null);for(var c=a;c>=0;){var f=o(l.stack[c]);l.stack[c].min=f.min,l.stack[c].max=f.max,c--}return{top:h,current:i,right:h!==i?h===t?h.right:t:i===t?i.right:t,currentToTopArr:s}},n=function(t){for(var e=0,i=t.length;e<i;){var r=o(t[e]);t[e].min=r.min,t[e].max=r.max,e++}},o=function(t){var e,i,r,l,n,o,a,h=t.interval.low,s=t.interval.high,u=isNaN(null===(e=t.left)||void 0===e?void 0:e.min)?null:t.left.min,c=isNaN(null===(i=t.right)||void 0===i?void 0:i.min)?null:null===(r=t.right)||void 0===r?void 0:r.min,f=isNaN(null===(l=t.left)||void 0===l?void 0:l.max)?null:null===(n=t.left)||void 0===n?void 0:n.max,p=isNaN(null===(o=t.right)||void 0===o?void 0:o.max)?null:null===(a=t.right)||void 0===a?void 0:a.max;return u<h&&null!==u&&(h=u),c<h&&null!==c&&(h=c),f>s&&null!==f&&(s=f),p>s&&null!==p&&(s=p),{min:h,max:s}},a=function(t,e){for(var i=0;t!==e;)t=t.interval.low>=e.interval.low?t.left:t.right,i++;return t===e?i++:null===t&&(i=0),i},h=function(t,e,i){var r=JSON.parse(JSON.stringify(t)),l=new Array(e),n=-1,o=0,h=-1;for(l[++n]=r;n>=0;){var s=l[n];s.id=++h,n--;var u=a(r,s)-1;u>o&&(o=u),s.level=u,null!==s.right&&(s.right.parentId=s.id,s.right.branched="right",s.right.parent=s,l[++n]=s.right),null!==s.left&&(s.left.parentId=s.id,s.left.branched="left",s.left.parent=s,l[++n]=s.left)}var c=[],f=[],p=72*Math.pow(2,o),v=new Array(e),g=-1;for(v[++g]=r;g>=0;){var d=v[g];if(g--,0===d.level)d.pos={c:p/2,x:p/2-36,y:5};else{var m=(Math.pow(2,o-d.level)-1)/2*72;"left"===d.branched?d.pos={c:d.parent.pos.c-m-36,x:d.parent.pos.c-m-72,y:5}:d.pos={c:d.parent.pos.c+m+36,x:d.parent.pos.c+m,y:5}}if(c[d.level]||(c[d.level]='<g class="interval-tree-print-level" data-attr="level-'.concat(d.level,'" transform="translate(',0,", ").concat(72*d.level,')">')),c[d.level]+='<g class="interval-tree-print-node" transform="translate('.concat(d.pos.x,", ").concat(d.pos.y,')">\n\t\t\t<text class="interval-tree-print-node-id" dx="5" dy="0">id: ').concat(d.id,'</text>\n\t\t\t<text class="interval-tree-print-node-parentId" dx="5" dy="15">pId: ').concat(isNaN(d.parentId)?"none":d.parentId,'</text>\n\t\t\t<text class="interval-tree-print-node-interval" dx="5" dy="30">l: ').concat(d.interval.low,", h: ").concat(d.interval.high,'</text>\n\t\t\t<text class="interval-tree-print-node-minmax" dx="5" dy="45">m: ').concat(d.min,", x: ").concat(d.max,"</text>\n\t\t\t").concat(i?'<text class="interval-tree-print-node-custom"  dx="5" dy="60">\n\t\t\t'.concat(i(d),"</text>"):"","\n\t\t\t</g>"),d.parent){var y='<line x1="'.concat(d.parent.pos.c,'" y1="').concat(72*d.parent.level+5+1+60+1,'" x2="').concat(d.pos.c,'" y2="').concat(72*d.level+5+1,'" class="interval-tree-print-arrow" stroke="black"/>');f.push(y)}null!==d.right&&(v[++g]=d.right),null!==d.left&&(v[++g]=d.left)}for(var w=0;w<c.length;w++)c[w]+="</g>";return'<svg class="interval-tree-print" width="'.concat(p+40,'" height="').concat(72*(o+1)+40,'"><g class="interval-tree-print-container" transform="translate(20, 20)">').concat(c.join("")).concat(f.join(""),"</g></svg>")};function s(t){this.root=null,this.length=0,Array.isArray(null==t?void 0:t.data)&&this.constructTree(t.data)}s.prototype.constructor=s,s.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},s.prototype.constructTree=function(t){for(var e=t.length,i=0;i<e;i++)this.root=this.insert(t[i],this.root)},s.prototype.insertRoot=function(t){return this.root=this.constructNode(t),this.root},s.prototype.getRoot=function(){return this.root},s.prototype.insert=function(t){return this.root=this._insert(this.root,t),this.root},s.prototype._insert=function(t,e){if(null===t)return this.length++,this.constructNode(e);if(t.interval.low>e.low)t.left=this._insert(t.left,e);else if(t.interval.low===e.low){this.length++;var i=t.left;t.left=this.constructNode(e),t.left.left=i;var r=o(t.left);t.left.min=r.min,t.left.max=r.max}else t.right=this._insert(t.right,e);return t.max<e.high&&(t.max=e.high),t.min>e.low&&(t.min=e.low),t},s.prototype.find=function(t,e,i,r){return this._find(this.root,t,e,i,r)},s.prototype._find=function(t,e,i,r,l){return null===t?null:!this.doOverlap(t.interval,e)||null!=i&&t.d!==i||l&&!l(t,e,i)?null!==t.left&&t.left.max>=e.low?this._find(t.left,e,i,r,l):null!==t.right&&t.right.min<=e.high?this._find(t.right,e,i,r,l):null:t},s.prototype.findAll=function(t,e,i,r){var l=[];return this._findAll(this.root,t,e,i,r,l),l},s.prototype._findAll=function(t,e,i,r,l,n){if(null===t)return null;!this.doOverlap(t.interval,e)||null!=i&&t.d!==i||l&&!l(t,e,i)||n.push(t),null!==t.left&&t.left.max>=e.low&&this._findAll(t.left,e,i,r,l,n),null!==t.right&&t.right.min<=e.high&&this._findAll(t.right,e,i,r,l,n)},s.prototype.remove=function(t,e,i){return this._remove(this.root,t,e,i,null),null},s.prototype._remove=function(t,e,i,r,a){if(null===t)return t;var h=2*Math.ceil(Math.log2(this.length));if(t.interval.low===e.low&&t.interval.high===e.high&&(null==i||t.d===i)&&(!r||r(t,e,i))){if(a={low:t.interval.low,high:t.interval.high,d:t.d},this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var s=l(t.right,h);t.interval=s.top.interval,t.d=s.top.d;var u=t.left;return t.left=s.top.left,t.right=s.right,s.current===s.top?t.left=u:s.current.left=u,n(s.currentToTopArr),t}if(t.interval.low>=e.low){t.left=this._remove(t.left,e,i,r,a);var c=o(t);t.min=c.min,t.max=c.max}else if(null!==t.right&&t.interval.low<e.low){t.right=this._remove(t.right,e,i,r,a);var f=o(t);t.min=f.min,t.max=f.max}return t},s.prototype.removeAll=function(t,e,i){var r=[];return this._removeAll(this.root,t,e,i,r),r},s.prototype._removeAll=function(t,e,i,r,a){if(null===t)return t;var h=2*Math.ceil(Math.log2(this.length));if(t.interval.low>=e.low){t.left=this._removeAll(t.left,e,i,r,a);var s=o(t);t.min=s.min,t.max=s.max}else if(null!==t.right&&t.interval.low<e.low){t.right=this._removeAll(t.right,e,i,r,a);var u=o(t);t.min=u.min,t.max=u.max}if(t.interval.low===e.low&&t.interval.high===e.high&&(null==i||t.d===i)&&(!r||r(t,e,i))){if(a.push({low:t.interval.low,high:t.interval.high,d:t.d}),this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var c=l(t.right,h);t.interval=c.top.interval,t.d=c.top.d;var f=t.left;t.left=c.top.left,t.right=c.right,c.current===c.top?t.left=f:c.current.left=f,n(c.currentToTopArr)}return t},s.prototype.getDataInArray=function(){var t=new Array(this.length);return this.getArray(this.root,t,{iter:0}),t},s.prototype.getArray=function(t,e,i){if(null===t)return null;null!==t.left&&this.getArray(t.left,e,i),null!==t&&(e[i.iter++]={interval:{low:t.interval.low,high:t.interval.high},d:t.d}),null!==t.right&&this.getArray(t.right,e,i)},s.prototype.doOverlap=function(t,e){return t.low<=e.high&&e.low<=t.high},s.prototype.isExact=function(t,e){return t.low===e.low&&t.high===e.high},s.prototype.printHtmlTree=function(){return h(this.root,this.length)};var u=s,c=i(1);function f(t){var e,i,l;this.options=t,this.root=null,this.length=0,this.initialStackSize=2*(null==t||null===(e=t.data)||void 0===e?void 0:e.length)||(null==t?void 0:t.initialStackSize)||500,this.initialQueueSize=2*(null==t||null===(i=t.data)||void 0===i?void 0:i.length)||(null==t?void 0:t.initialQueueSize)||500,this.queue=new c.ArrayQueue({initialSize:this.initialQueueSize}),this.stack=new r.ArrayStack({initialSize:this.initialStackSize}),this.path=new r.ArrayStack({initialSize:this.initialStackSize}),this.result=new r.ArrayStack({initialSize:this.initialStackSize}),this.removeList=new r.ArrayStack({initialSize:this.initialStackSize}),Array.isArray(null==t?void 0:t.data)&&this.constructTree(t.data),null===(l=this.options)||void 0===l||delete l.data}f.prototype.constructor=f,f.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},f.prototype.constructTree=function(t){for(var e=t.length,i=0;i<e;i++)this.insert(t[i])},f.prototype.getRoot=function(){return this.root},f.prototype.insert=function(t){return this._insert(this.root,t)},f.prototype._insert=function(t,e){for(var i=this.constructNode(e),r=t,l=null;null!==r;)if(l=r,r.max<e.high&&(r.max=e.high),r.min>e.low&&(r.min=e.low),r.interval.low>e.low)r=r.left;else{if(r.interval.low===e.low)break;r=r.right}if(null===l)l=i,this.root=i;else if(l.interval.low>e.low)l.left=i;else if(l.interval.low===e.low){var n=l.left;l.left=i,l.left.left=n;var a=o(l.left);l.left.min=a.min,l.left.max=a.max}else l.right=i;return this.length++,i},f.prototype.find=function(t,e,i,r){return this._find(this.root,t,e,i,r)},f.prototype._find=function(t,e,i,r,l){if(!0===(r=r||!1)?r=this.isExact:!1===r&&(r=this.doOverlap),null===t)return null;for(;null!=t;){if(r(t.interval,e)&&(null==i||t.d===i)&&(!l||l(t,e,i)))return t;if(null!==t.left&&t.left.max>=e.low)t=t.left;else{if(!(null!==t.right&&t.right.min<=e.high))return null;t=t.right}}return null},f.prototype.findAll=function(t,e,i,r){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._findAll(this.root,t,e,i,r,l)},f.prototype._findAll=function(t,e,i,r,l,n){if(!0===(r=r||!1)?r=this.isExact:!1===r&&(r=this.doOverlap),this.stack.empty(),this.queue.empty(),this.queue.enqueue(t),null===t)return null;for(;!this.queue.isEmpty();){var o=this.queue.dequeue();if(r(o.interval,e)&&(null==i||o.d===i)&&(!l||l(o,e,i))&&(this.stack.push(o),!0===n))return this.stack.getData();null!==o.left&&o.left.max>=e.low&&this.queue.enqueue(o.left),null!==o.right&&o.right.min<=e.high&&this.queue.enqueue(o.right)}return this.stack.getData()},f.prototype.findUsingComparator=function(t,e,i){return this._findUsingComparator(this.root,t,e,i)},f.prototype._findUsingComparator=function(t,e,i,r){if(null===t)return[];var l;for(this.result.empty(),this.stack.empty(),this.stack.push(t);!this.stack.isEmpty();)e(l=this.stack.pop())&&this.result.push(l),null!==l.right&&r(l)&&this.stack.push(l.right),null!==l.left&&i(l)&&this.stack.push(l.left);return this.result.getData()},f.prototype.remove=function(t,e,i){return this._remove(this.root,t,e,i)},f.prototype._remove=function(t,e,i,r){var a=null,h=null,s=null,u=2*Math.ceil(Math.log2(this.length));if(this.stack.empty(),this.path.empty(),this.stack.push(t),null===t)return null;for(;!this.stack.isEmpty();){var c=this.stack.pop();if(c.interval.low===e.low&&c.interval.high===e.high&&(null==i||c.d===i)&&(!r||r(c,e,i))){if(s={low:c.interval.low,high:c.interval.high,d:c.d},this.length--,null===c.left)a?(a[h]=c.right,c=c.right):this.root=c.right;else if(null===c.right)a?(a[h]=c.left,c=c.left):this.root=c.left;else{var f=l(c.right,u);c.interval=f.top.interval,c.d=f.top.d;var p=c.left;c.left=f.top.left,c.right=f.right,f.current===f.top?c.left=p:f.current.left=p,n(f.currentToTopArr)}c&&this.path.push(c);break}this.path.push(c),null!==c.right&&c.interval.low<e.low?(a=c,h="right",this.stack.push(c.right)):null!==c.left&&c.interval.low>=e.low&&(a=c,h="left",this.stack.push(c.left))}for(;!this.path.isEmpty();){var v=this.path.pop(),g=o(v);v.min=g.min,v.max=g.max}return s},f.prototype.removeAll=function(t,e,i){return this._removeAll(this.root,t,e,i)},f.prototype._removeAll=function(t,e,i,r){var a=null,h=null,s=2*Math.ceil(Math.log2(this.length));if(this.removeList.empty(),this.stack.empty(),this.path.empty(),this.stack.push(t),null===t)return null;for(;!this.stack.isEmpty();){var u=this.stack.pop();if(u.interval.low!==e.low||u.interval.high!==e.high||null!=i&&u.d!==i||r&&!r(u,e,i))this.path.push(u),null!==u.right&&u.interval.low<e.low?(a=u,h="right",this.stack.push(u.right)):null!==u.left&&u.interval.low>=e.low&&(a=u,h="left",this.stack.push(u.left));else{if(this.removeList.push({low:u.interval.low,high:u.interval.high,d:u.d}),this.length--,null===u.left)a?(a[h]=u.right,u=u.right):this.root=u.right;else if(null===u.right)a?(a[h]=u.left,u=u.left):this.root=u.left;else{var c=l(u.right,s);u.interval=c.top.interval,u.d=c.top.d;var f=u.left;u.left=c.top.left,u.right=c.right,c.current===c.top?u.left=f:c.current.left=f,n(c.currentToTopArr)}u&&this.stack.push(u)}}for(;!this.path.isEmpty();){var p=this.path.pop(),v=o(p);p.min=v.min,p.max=v.max}return this.removeList.getData()},f.prototype.getSortedData=function(){if(null===this.root)return[];var t=new Array(this.length),e=0;this.stack.empty();for(var i=this.root;null!==i||!this.stack.isEmpty();){for(;null!==i;)this.stack.push(i),i=i.left;i=this.stack.pop(),t[e++]={interval:{low:i.interval.low,high:i.interval.high},d:i.d},i=i.right}return t},f.prototype.doOverlap=function(t,e){return t.low<=e.high&&e.low<=t.high},f.prototype.isExact=function(t,e){return t.low===e.low&&t.high===e.high},f.prototype.setData=function(t){this.emptyTree(),this.constructTree(t)},f.prototype.reset=function(){this.root=null,this.length=0},f.prototype.emptyTree=function(){this.root=null,this.length=0;for(var t=Math.max(this.queue.queue.length,this.stack.stack.length,this.path.stack.length,this.result.stack.length,this.removeList.stack.length),e=0;e<t;e++)this.queue.queue[e]&&(this.queue.queue[e].interval=null,this.queue.queue[e].d=null,this.queue.queue[e].left=null,this.queue.queue[e].right=null),this.stack.stack[e]&&(this.stack.stack[e].interval=null,this.stack.stack[e].d=null,this.stack.stack[e].left=null,this.stack.stack[e].right=null),this.path.stack[e]&&(this.path.stack[e].interval=null,this.path.stack[e].d=null,this.path.stack[e].left=null,this.path.stack[e].right=null),this.result.stack[e]&&(this.result.stack[e].interval=null,this.result.stack[e].d=null,this.result.stack[e].left=null,this.result.stack[e].right=null),this.removeList.stack[e]&&(this.removeList.stack[e].interval=null,this.removeList.stack[e].d=null,this.removeList.stack[e].left=null,this.removeList.stack[e].right=null)},f.prototype.printHtmlTree=function(t){return h(this.root,this.length,t)};var p=f;i(2)}])}));
/** @license IntervalTreeJS

IntervalTreeJS, a JavaScript Binary Search Tree library that helps to query, insert and delete intervals in the binary search tree.

Copyright Â© 2019-2020 Subendra Kumar Sharma. All Rights reserved. (jobs.sharma.subendra.kr@gmail.com)

This file is part of IntervalTreeJS.

IntervalTreeJS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

IntervalTreeJS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with IntervalTreeJS.  If not, see <https://www.gnu.org/licenses/>.

Written by Subendra Kumar Sharma.

*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Stack"),require("Queue")):"function"==typeof define&&define.amd?define(["Stack","Queue"],e):"object"==typeof exports?exports.IntervalTreeJS=e(require("Stack"),require("Queue")):t.IntervalTreeJS=e(t.Stack,t.Queue)}(window,(function(t,e){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var l=e[i]={i:i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)r.d(i,l,function(e){return t[e]}.bind(null,l));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="assets",r(r.s=3)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){},function(t,e,r){"use strict";r.r(e),r.d(e,"IntervalTreesRecursive",(function(){return u})),r.d(e,"IntervalTreesIterative",(function(){return p}));var i=r(0),l=function(t,e){var r=t,l=new i.ArrayStack({initialSize:e});for(l.push(r);null!==r.left;)r=r.left,l.push(r);for(var n=r.interval.low,a=l.ptr,h=null,s=new Array(a+1),u=-1;a>=0&&l.stack[a].interval.low===n;)h=l.stack[a],a--,s[++u]=h;s.length=u+1,a>=0&&(null!==h.right?(l.stack[a].left=h.right,h.right=null):l.stack[a].left=null);for(var f=a;f>=0;){var c=o(l.stack[f]);l.stack[f].min=c.min,l.stack[f].max=c.max,f--}return{top:h,current:r,right:h!==r?h===t?h.right:t:r===t?r.right:t,currentToTopArr:s}},n=function(t){for(var e=0,r=t.length;e<r;){var i=o(t[e]);t[e].min=i.min,t[e].max=i.max,e++}},o=function(t){var e,r,i,l,n,o,a,h=t.interval.low,s=t.interval.high,u=isNaN(null===(e=t.left)||void 0===e?void 0:e.min)?null:t.left.min,f=isNaN(null===(r=t.right)||void 0===r?void 0:r.min)?null:null===(i=t.right)||void 0===i?void 0:i.min,c=isNaN(null===(l=t.left)||void 0===l?void 0:l.max)?null:null===(n=t.left)||void 0===n?void 0:n.max,p=isNaN(null===(o=t.right)||void 0===o?void 0:o.max)?null:null===(a=t.right)||void 0===a?void 0:a.max;return u<h&&null!==u&&(h=u),f<h&&null!==f&&(h=f),c>s&&null!==c&&(s=c),p>s&&null!==p&&(s=p),{min:h,max:s}},a=function(t,e){for(var r=0;t!==e;)t=t.interval.low>=e.interval.low?t.left:t.right,r++;return t===e?r++:null===t&&(r=0),r},h=function(t,e,r){var i=JSON.parse(JSON.stringify(t)),l=new Array(e),n=-1,o=0,h=-1;for(l[++n]=i;n>=0;){var s=l[n];s.id=++h,n--;var u=a(i,s)-1;u>o&&(o=u),s.level=u,null!==s.right&&(s.right.parentId=s.id,s.right.branched="right",s.right.parent=s,l[++n]=s.right),null!==s.left&&(s.left.parentId=s.id,s.left.branched="left",s.left.parent=s,l[++n]=s.left)}var f=[],c=[],p=72*Math.pow(2,o),v=new Array(e),g=-1;for(v[++g]=i;g>=0;){var d=v[g];if(g--,0===d.level)d.pos={c:p/2,x:p/2-36,y:5};else{var m=(Math.pow(2,o-d.level)-1)/2*72;"left"===d.branched?d.pos={c:d.parent.pos.c-m-36,x:d.parent.pos.c-m-72,y:5}:d.pos={c:d.parent.pos.c+m+36,x:d.parent.pos.c+m,y:5}}if(f[d.level]||(f[d.level]='<g class="interval-tree-print-level" data-attr="level-'.concat(d.level,'" transform="translate(',0,", ").concat(72*d.level,')">')),f[d.level]+='<g class="interval-tree-print-node" transform="translate('.concat(d.pos.x,", ").concat(d.pos.y,')">\n\t\t\t<text class="interval-tree-print-node-id" dx="5" dy="0">id: ').concat(d.id,'</text>\n\t\t\t<text class="interval-tree-print-node-parentId" dx="5" dy="15">pId: ').concat(isNaN(d.parentId)?"none":d.parentId,'</text>\n\t\t\t<text class="interval-tree-print-node-interval" dx="5" dy="30">l: ').concat(d.interval.low,", h: ").concat(d.interval.high,'</text>\n\t\t\t<text class="interval-tree-print-node-minmax" dx="5" dy="45">m: ').concat(d.min,", x: ").concat(d.max,"</text>\n\t\t\t").concat(r?'<text class="interval-tree-print-node-custom"  dx="5" dy="60">\n\t\t\t'.concat(r(d),"</text>"):"","\n\t\t\t</g>"),d.parent){var y='<line x1="'.concat(d.parent.pos.c,'" y1="').concat(72*d.parent.level+5+1+60+1,'" x2="').concat(d.pos.c,'" y2="').concat(72*d.level+5+1,'" class="interval-tree-print-arrow" stroke="black"/>');c.push(y)}null!==d.right&&(v[++g]=d.right),null!==d.left&&(v[++g]=d.left)}for(var w=0;w<f.length;w++)f[w]+="</g>";return'<svg class="interval-tree-print" width="'.concat(p+40,'" height="').concat(72*(o+1)+40,'"><g class="interval-tree-print-container" transform="translate(20, 20)">').concat(f.join("")).concat(c.join(""),"</g></svg>")};function s(t){this.root=null,this.length=0,Array.isArray(null==t?void 0:t.data)&&this.constructTree(t.data)}s.prototype.constructor=s,s.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},s.prototype.constructTree=function(t){for(var e=t.length,r=0;r<e;r++)this.root=this.insert(t[r],this.root)},s.prototype.insertRoot=function(t){return this.root=this.constructNode(t),this.root},s.prototype.getRoot=function(){return this.root},s.prototype.insert=function(t){return this.root=this._insert(this.root,t),this.root},s.prototype._insert=function(t,e){if(null===t)return this.length++,this.constructNode(e);if(t.interval.low>e.low)t.left=this._insert(t.left,e);else if(t.interval.low===e.low){this.length++;var r=t.left;t.left=this.constructNode(e),t.left.left=r;var i=o(t.left);t.left.min=i.min,t.left.max=i.max}else t.right=this._insert(t.right,e);return t.max<e.high&&(t.max=e.high),t.min>e.low&&(t.min=e.low),t},s.prototype.find=function(t,e,r,i){return this._find(this.root,t,e,r,i)},s.prototype._find=function(t,e,r,i,l){return null===t?null:!this.doOverlap(t.interval,e)||null!=r&&t.d!==r||l&&!l(t,e,r)?null!==t.left&&t.left.max>=e.low?this._find(t.left,e,r,i,l):this._find(t.right,e,r,i,l):t},s.prototype.findAll=function(t,e,r,i){var l=[];return this._findAll(this.root,t,e,r,i,l),l},s.prototype._findAll=function(t,e,r,i,l,n){if(null===t)return null;!this.doOverlap(t.interval,e)||null!=r&&t.d!==r||l&&!l(t,e,r)||n.push(t),null!==t.left&&t.left.max>=e.low&&this._findAll(t.left,e,r,i,l,n),null!==t.right&&t.right.min<=e.high&&this._findAll(t.right,e,r,i,l,n)},s.prototype.remove=function(t,e,r){return this._remove(this.root,t,e,r,null),null},s.prototype._remove=function(t,e,r,i,a){if(null===t)return t;var h=2*Math.ceil(Math.log2(this.length));if(t.interval.low===e.low&&t.interval.high===e.high&&(null==r||t.d===r)&&(!i||i(t,e,r))){if(a={low:t.interval.low,high:t.interval.high,d:t.d},this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var s=l(t.right,h);t.interval=s.top.interval,t.d=s.top.d;var u=t.left;return t.left=s.top.left,t.right=s.right,s.current===s.top?t.left=u:s.current.left=u,n(s.currentToTopArr),t}if(t.interval.low>=e.low){t.left=this._remove(t.left,e,r,i,a);var f=o(t);t.min=f.min,t.max=f.max}else if(null!==t.right&&t.interval.low<e.low){t.right=this._remove(t.right,e,r,i,a);var c=o(t);t.min=c.min,t.max=c.max}return t},s.prototype.removeAll=function(t,e,r){var i=[];return this._removeAll(this.root,t,e,r,i),i},s.prototype._removeAll=function(t,e,r,i,a){if(null===t)return t;var h=2*Math.ceil(Math.log2(this.length));if(t.interval.low>=e.low){t.left=this._removeAll(t.left,e,r,i,a);var s=o(t);t.min=s.min,t.max=s.max}else if(null!==t.right&&t.interval.low<e.low){t.right=this._removeAll(t.right,e,r,i,a);var u=o(t);t.min=u.min,t.max=u.max}if(t.interval.low===e.low&&t.interval.high===e.high&&(null==r||t.d===r)&&(!i||i(t,e,r))){if(a.push({low:t.interval.low,high:t.interval.high,d:t.d}),this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var f=l(t.right,h);t.interval=f.top.interval,t.d=f.top.d;var c=t.left;t.left=f.top.left,t.right=f.right,f.current===f.top?t.left=c:f.current.left=c,n(f.currentToTopArr)}return t},s.prototype.getDataInArray=function(){var t=new Array(this.length);return this.getArray(this.root,t,{iter:0}),t},s.prototype.getArray=function(t,e,r){if(null===t)return null;null!==t.left&&this.getArray(t.left,e,r),null!==t&&(e[r.iter++]={interval:{low:t.interval.low,high:t.interval.high},d:t.d}),null!==t.right&&this.getArray(t.right,e,r)},s.prototype.doOverlap=function(t,e){return t.low<=e.high&&e.low<=t.high},s.prototype.isExact=function(t,e){return t.low===e.low&&t.high===e.high},s.prototype.printHtmlTree=function(){return h(this.root,this.length)};var u=s,f=r(1);function c(t){var e,r,l;this.options=t,this.root=null,this.length=0,this.initialStackSize=2*(null==t||null===(e=t.data)||void 0===e?void 0:e.length)||(null==t?void 0:t.initialStackSize)||500,this.initialQueueSize=2*(null==t||null===(r=t.data)||void 0===r?void 0:r.length)||(null==t?void 0:t.initialQueueSize)||500,this.queue=new f.ArrayQueue({initialSize:this.initialQueueSize}),this.stack=new i.ArrayStack({initialSize:this.initialStackSize}),this.path=new i.ArrayStack({initialSize:this.initialStackSize}),this.result=new i.ArrayStack({initialSize:this.initialStackSize}),this.removeList=new i.ArrayStack({initialSize:this.initialStackSize}),Array.isArray(null==t?void 0:t.data)&&this.constructTree(t.data),null===(l=this.options)||void 0===l||delete l.data}c.prototype.constructor=c,c.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},c.prototype.constructTree=function(t){for(var e=t.length,r=0;r<e;r++)this.insert(t[r])},c.prototype.getRoot=function(){return this.root},c.prototype.insert=function(t){return this._insert(this.root,t)},c.prototype._insert=function(t,e){for(var r=this.constructNode(e),i=t,l=null;null!==i;)if(l=i,i.max<e.high&&(i.max=e.high),i.min>e.low&&(i.min=e.low),i.interval.low>e.low)i=i.left;else{if(i.interval.low===e.low)break;i=i.right}if(null===l)l=r,this.root=r;else if(l.interval.low>e.low)l.left=r;else if(l.interval.low===e.low){var n=l.left;l.left=r,l.left.left=n;var a=o(l.left);l.left.min=a.min,l.left.max=a.max}else l.right=r;return this.length++,r},c.prototype.find=function(t,e,r,i){return this._find(this.root,t,e,r,i)},c.prototype._find=function(t,e,r,i,l){if(!0===(i=i||!1)?i=this.isExact:!1===i&&(i=this.doOverlap),null===t)return null;for(;null!=t;){if(i(t.interval,e)&&(null==r||t.d===r)&&(!l||l(t,e,r)))return t;t=null!==t.left&&t.left.max>=e.low?t.left:t.right}return null},c.prototype.findAll=function(t,e,r,i){return this._findAll(this.root,t,e,r,i)},c.prototype._findAll=function(t,e,r,i,l){if(!0===(i=i||!1)?i=this.isExact:!1===i&&(i=this.doOverlap),this.stack.empty(),this.queue.empty(),this.queue.enqueue(t),null===t)return null;for(;!this.queue.isEmpty();){var n=this.queue.dequeue();!i(n.interval,e)||null!=r&&n.d!==r||l&&!l(n,e,r)||this.stack.push(n),null!==n.left&&n.left.max>=e.low&&this.queue.enqueue(n.left),null!==n.right&&n.right.min<=e.high&&this.queue.enqueue(n.right)}return this.stack.getData()},c.prototype.findUsingComparator=function(t,e,r){return this._findUsingComparator(this.root,t,e,r)},c.prototype._findUsingComparator=function(t,e,r,i){if(null===t)return[];var l;for(this.result.empty(),this.stack.empty(),this.stack.push(t);!this.stack.isEmpty();)e(l=this.stack.pop())&&this.result.push(l),null!==l.right&&i(l)&&this.stack.push(l.right),null!==l.left&&r(l)&&this.stack.push(l.left);return this.result.getData()},c.prototype.remove=function(t,e,r){return this._remove(this.root,t,e,r)},c.prototype._remove=function(t,e,r,i){var a=null,h=null,s=null,u=2*Math.ceil(Math.log2(this.length));if(this.stack.empty(),this.path.empty(),this.stack.push(t),null===t)return null;for(;!this.stack.isEmpty();){var f=this.stack.pop();if(f.interval.low===e.low&&f.interval.high===e.high&&(null==r||f.d===r)&&(!i||i(f,e,r))){if(s={low:f.interval.low,high:f.interval.high,d:f.d},this.length--,null===f.left)a?(a[h]=f.right,f=f.right):this.root=f.right;else if(null===f.right)a?(a[h]=f.left,f=f.left):this.root=f.left;else{var c=l(f.right,u);f.interval=c.top.interval,f.d=c.top.d;var p=f.left;f.left=c.top.left,f.right=c.right,c.current===c.top?f.left=p:c.current.left=p,n(c.currentToTopArr)}f&&this.path.push(f);break}this.path.push(f),null!==f.right&&f.interval.low<e.low?(a=f,h="right",this.stack.push(f.right)):null!==f.left&&f.interval.low>=e.low&&(a=f,h="left",this.stack.push(f.left))}for(;!this.path.isEmpty();){var v=this.path.pop(),g=o(v);v.min=g.min,v.max=g.max}return s},c.prototype.removeAll=function(t,e,r){return this._removeAll(this.root,t,e,r)},c.prototype._removeAll=function(t,e,r,i){var a=null,h=null,s=2*Math.ceil(Math.log2(this.length));if(this.removeList.empty(),this.stack.empty(),this.path.empty(),this.stack.push(t),null===t)return null;for(;!this.stack.isEmpty();){var u=this.stack.pop();if(u.interval.low!==e.low||u.interval.high!==e.high||null!=r&&u.d!==r||i&&!i(u,e,r))this.path.push(u),null!==u.right&&u.interval.low<e.low?(a=u,h="right",this.stack.push(u.right)):null!==u.left&&u.interval.low>=e.low&&(a=u,h="left",this.stack.push(u.left));else{if(this.removeList.push({low:u.interval.low,high:u.interval.high,d:u.d}),this.length--,null===u.left)a?(a[h]=u.right,u=u.right):this.root=u.right;else if(null===u.right)a?(a[h]=u.left,u=u.left):this.root=u.left;else{var f=l(u.right,s);u.interval=f.top.interval,u.d=f.top.d;var c=u.left;u.left=f.top.left,u.right=f.right,f.current===f.top?u.left=c:f.current.left=c,n(f.currentToTopArr)}u&&this.stack.push(u)}}for(;!this.path.isEmpty();){var p=this.path.pop(),v=o(p);p.min=v.min,p.max=v.max}return this.removeList.getData()},c.prototype.getSortedData=function(){if(null===this.root)return[];var t=new Array(this.length),e=0;this.stack.empty();for(var r=this.root;null!==r||!this.stack.isEmpty();){for(;null!==r;)this.stack.push(r),r=r.left;r=this.stack.pop(),t[e++]={interval:{low:r.interval.low,high:r.interval.high},d:r.d},r=r.right}return t},c.prototype.doOverlap=function(t,e){return t.low<=e.high&&e.low<=t.high},c.prototype.isExact=function(t,e){return t.low===e.low&&t.high===e.high},c.prototype.setData=function(t){this.emptyTree(),this.constructTree(t)},c.prototype.emptyTree=function(){this.root=null,this.length=0;for(var t=this.queue.queue.length,e=0;e<t;e++)this.queue.queue[e]&&(this.queue.queue[e].interval=null,this.queue.queue[e].d=null,this.queue.queue[e].left=null,this.queue.queue[e].right=null);t=this.stack.stack.length;for(var r=0;r<t;r++)this.stack.stack[r]&&(this.stack.stack[r].interval=null,this.stack.stack[r].d=null,this.stack.stack[r].left=null,this.stack.stack[r].right=null);t=this.path.stack.length;for(var i=0;i<t;i++)this.path.stack[i]&&(this.path.stack[i].interval=null,this.path.stack[i].d=null,this.path.stack[i].left=null,this.path.stack[i].right=null);t=this.result.stack.length;for(var l=0;l<t;l++)this.result.stack[l]&&(this.result.stack[l].interval=null,this.result.stack[l].d=null,this.result.stack[l].left=null,this.result.stack[l].right=null);t=this.removeList.stack.length;for(var n=0;n<t;n++)this.removeList.stack[n]&&(this.removeList.stack[n].interval=null,this.removeList.stack[n].d=null,this.removeList.stack[n].left=null,this.removeList.stack[n].right=null)},c.prototype.printHtmlTree=function(t){return h(this.root,this.length,t)};var p=c;r(2)}])}));
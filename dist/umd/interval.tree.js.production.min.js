/** @license IntervalTreeJS

IntervalTreeJS, a JavaScript Binary Search Tree library that helps to query, insert and delete intervals in the binary search tree.

Copyright Â© 2019-2020 Subendra Kumar Sharma. All Rights reserved. (jobs.sharma.subendra.kr@gmail.com)

This file is part of IntervalTreeJS.

IntervalTreeJS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

IntervalTreeJS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with IntervalTreeJS.  If not, see <https://www.gnu.org/licenses/>.

Written by Subendra Kumar Sharma.

*/
!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.IntervalTreeJS=r():t.IntervalTreeJS=r()}(window,(function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var l=r[n]={i:n,l:!1,exports:{}};return t[n].call(l.exports,l,l.exports,e),l.l=!0,l.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var l in t)e.d(n,l,function(r){return t[r]}.bind(null,l));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="assets",e(e.s=1)}([function(t,r,e){},function(t,r,e){"use strict";e.r(r),e.d(r,"IntervalTreesRecursive",(function(){return f})),e.d(r,"IntervalTreesIterative",(function(){return v}));var n=function(t,r,e){var n=t,l=new Array(e),a=-1;for(l[++a]=n;null!==n.left;)n,n=n.left,l[++a]=n;for(var h=n.interval.low,u=a,f=null,s=new Array(a+1),v=-1;u>=0&&l[u].interval.low===h;)f=l[u],u--,s[++v]=f;for(u>=0&&(null!==f.right?(l[u].left=f.right,f.right=null):l[u].left=null),a=u;a>=0;){var c=i(l[a]);l[a].min=c.min,l[a].max=c.max,a--}return{top:f,current:n,right:f!==n?f===t?f.right:t:n===t?n.right:t,currentToTopArr:s=o(s)}},l=function(t){for(var r=0,e=t.length;r<e;){var n=i(t[r]);t[r].min=n.min,t[r].max=n.max,r++}},i=function(t){var r,e,n,l,i,o,a,h=t.interval.low,u=t.interval.high,f=isNaN(null===(r=t.left)||void 0===r?void 0:r.min)?null:t.left.min,s=isNaN(null===(e=t.right)||void 0===e?void 0:e.min)?null:null===(n=t.right)||void 0===n?void 0:n.min,v=isNaN(null===(l=t.left)||void 0===l?void 0:l.max)?null:null===(i=t.left)||void 0===i?void 0:i.max,c=isNaN(null===(o=t.right)||void 0===o?void 0:o.max)?null:null===(a=t.right)||void 0===a?void 0:a.max;return f<h&&null!==f&&(h=f),s<h&&null!==s&&(h=s),v>u&&null!==v&&(u=v),c>u&&null!==c&&(u=c),{min:h,max:u}},o=function(t){for(var r=0,e=t.length,n=0;n<e;n++)t[n]&&r++;for(var l=new Array(r),i=0;i<r;i++)l[i]=t[i];return l},a=function(t,r){for(var e=0;t!==r;)t=t.interval.low>=r.interval.low?t.left:t.right,e++;return t===r?e++:null===t&&(e=0),e},h=function(t,r){var e=JSON.parse(JSON.stringify(t)),n=new Array(r),l=-1,i=0,o=-1;for(n[++l]=e;l>=0;){var h=n[l];h.id=++o,l--;var u=a(e,h)-1;u>i&&(i=u),h.level=u,null!==h.right&&(h.right.parentId=h.id,h.right.branched="right",h.right.parent=h,n[++l]=h.right),null!==h.left&&(h.left.parentId=h.id,h.left.branched="left",h.left.parent=h,n[++l]=h.left)}var f=[],s=[],v=72*Math.pow(2,i),c=new Array(r),p=-1;for(c[++p]=e;p>=0;){var g=c[p];if(p--,0===g.level)g.pos={c:v/2,x:v/2-36,y:5};else{var d=(Math.pow(2,i-g.level)-1)/2*72;"left"===g.branched?g.pos={c:g.parent.pos.c-d-36,x:g.parent.pos.c-d-72,y:5}:g.pos={c:g.parent.pos.c+d+36,x:g.parent.pos.c+d,y:5}}if(f[g.level]||(f[g.level]='<g class="interval-tree-print-level" data-attr="level-'.concat(g.level,'" transform="translate(',0,", ").concat(72*g.level,')">')),f[g.level]+='<g class="interval-tree-print-node" transform="translate('.concat(g.pos.x,", ").concat(g.pos.y,')">\n\t\t\t<text class="interval-tree-print-node-id" dx="5" dy="0">id: ').concat(g.id,'</text>\n\t\t\t<text class="interval-tree-print-node-parentId" dx="5" dy="15">pId: ').concat(isNaN(g.parentId)?"none":g.parentId,'</text>\n\t\t\t<text class="interval-tree-print-node-interval" dx="5" dy="30">l: ').concat(g.interval.low,", h: ").concat(g.interval.high,'</text>\n\t\t\t<text class="interval-tree-print-node-minmax" dx="5" dy="45">m: ').concat(g.min,", x: ").concat(g.max,"</text></g>"),g.parent){var m='<line x1="'.concat(g.parent.pos.c,'" y1="').concat(72*g.parent.level+5+1+60+1,'" x2="').concat(g.pos.c,'" y2="').concat(72*g.level+5+1,'" class="interval-tree-print-arrow" stroke="black"/>');s.push(m)}null!==g.right&&(c[++p]=g.right),null!==g.left&&(c[++p]=g.left)}for(var w=0;w<f.length;w++)f[w]+="</g>";return'<svg class="interval-tree-print" width="'.concat(v+40,'" height="').concat(72*(i+1)+40,'"><g class="interval-tree-print-container" transform="translate(20, 20)">').concat(f.join("")).concat(s.join(""),"</g></svg>")};function u(t){this.root=null,this.data=[],this.length=0,t&&Array.isArray(t.data)&&(this.data=JSON.parse(JSON.stringify(t.data)),this.constructTree())}u.prototype.constructor=u,u.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},u.prototype.constructTree=function(){for(var t=this.data.length,r=0;r<t;r++)this.root=this.insert(this.data[r],this.root)},u.prototype.insertRoot=function(t){return this.root=this.constructNode(t),this.root},u.prototype.getRoot=function(){return this.root},u.prototype.insert=function(t){return this.root=this._insert(this.root,t),this.root},u.prototype._insert=function(t,r){if(null===t)return this.length++,this.constructNode(r);if(t.interval.low>r.low)t.left=this._insert(t.left,r);else if(t.interval.low===r.low){this.length++;var e=t.left;t.left=this.constructNode(r),t.left.left=e;var n=i(t.left);t.left.min=n.min,t.left.max=n.max}else t.right=this._insert(t.right,r);return t.max<r.high&&(t.max=r.high),t.min>r.low&&(t.min=r.low),t},u.prototype.find=function(t,r){return this._find(this.root,t,r)},u.prototype._find=function(t,r,e){return null===t?null:!this.doOverlap(t.interval,r)||null!=e&&t.d!==e?null!==t.left&&t.left.max>=r.low?find(t.left,r):find(t.right,r):t},u.prototype.findAll=function(t,r){var e=[];return this._findAll(this.root,t,r,e),e},u.prototype._findAll=function(t,r,e,n){if(null===t)return null;!this.doOverlap(t.interval,r)||null!=e&&t.d!==e||n.push(t),null!==t.left&&t.left.max>=r.low&&this._findAll(t.left,r,n),null!==t.right&&t.right.min<=r.high&&this._findAll(t.right,r,n)},u.prototype.remove=function(t,r){return this._remove(this.root,t,r,null),null},u.prototype._remove=function(t,r,e,o){if(null===t)return t;if(t.interval.low===r.low&&t.interval.high===r.high&&(null==e||t.d===e)){if(o={low:t.interval.low,high:t.interval.high,d:t.d},this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var a=n(t.right);t.interval=a.top.interval,t.d=a.top.d;var h=t.left;return t.left=a.top.left,t.right=a.right,a.current===a.top?t.left=h:a.current.left=h,l(a.currentToTopArr),t}if(t.interval.low>=r.low){t.left=this._remove(t.left,r,e,o);var u=i(t);t.min=u.min,t.max=u.max}else if(null!==t.right&&t.interval.low<r.low){t.right=this._remove(t.right,r,e,o);var f=i(t);t.min=f.min,t.max=f.max}return t},u.prototype.removeAll=function(t,r){var e=[];return this._removeAll(this.root,t,r,e),e},u.prototype._removeAll=function(t,r,e,o){if(null===t)return t;if(t.interval.low>=r.low){t.left=this._removeAll(t.left,r,e,o);var a=i(t);t.min=a.min,t.max=a.max}else if(null!==t.right&&t.interval.low<r.low){t.right=this._removeAll(t.right,r,e,o);var h=i(t);t.min=h.min,t.max=h.max}if(t.interval.low===r.low&&t.interval.high===r.high&&(null==e||t.d===e)){if(o.push({low:t.interval.low,high:t.interval.high,d:t.d}),this.length--,null===t.left)return t.right;if(null===t.right)return t.left;var u=n(t.right);t.interval=u.top.interval,t.d=u.top.d;var f=t.left;t.left=u.top.left,t.right=u.right,u.current===u.top?t.left=f:u.current.left=f,l(u.currentToTopArr)}return t},u.prototype.getDataInArray=function(){var t=new Array(this.length);return this.getArray(this.root,t,{iter:0}),t},u.prototype.getArray=function(t,r,e){if(null===t)return null;null!==t.left&&this.getArray(t.left,r,e),null!==t&&(r[e.iter++]={interval:{low:t.interval.low,high:t.interval.high},d:t.d}),null!==t.right&&this.getArray(t.right,r,e)},u.prototype.doOverlap=function(t,r){return t.low<=r.high&&r.low<=t.high},u.prototype.isExact=function(t,r){return t.low===r.low&&t.high===r.high},u.prototype.printHtmlTree=function(){return h(this.root,this.length)};var f=u;function s(t){this.root=null,this.data=[],this.length=0,t&&Array.isArray(t.data)&&(this.data=JSON.parse(JSON.stringify(t.data)),this.constructTree())}s.prototype.constructor=s,s.prototype.constructNode=function(t){return{max:t.high,min:t.low,interval:{low:t.low,high:t.high},d:t.d,left:null,right:null}},s.prototype.constructTree=function(){for(var t=this.data.length,r=0;r<t;r++)this.insert(this.data[r])},s.prototype.insertRoot=function(t){return this.root=this.constructNode(t),this.root},s.prototype.getRoot=function(){return this.root},s.prototype.insert=function(t){return this._insert(this.root,t)},s.prototype._insert=function(t,r){for(var e=this.constructNode(r),n=t,l=null;null!==n;)if(l=n,n.max<r.high&&(n.max=r.high),n.min>r.low&&(n.min=r.low),n.interval.low>r.low)n=n.left;else{if(n.interval.low===r.low)break;n=n.right}if(null===l)l=e,this.root=e;else if(l.interval.low>r.low)l.left=e;else if(l.interval.low===r.low){var o=l.left;l.left=e,l.left.left=o;var a=i(l.left);l.left.min=a.min,l.left.max=a.max}else l.right=e;return this.length++,e},s.prototype.find=function(t,r,e){return this._find(this.root,t,r,e)},s.prototype._find=function(t,r,e,n){if(!0===(n=n||!1)?n=this.isExact:!1===n&&(n=this.doOverlap),null===t)return null;for(;null!=t;){if(n(t.interval,r)&&(null==e||t.d===e))return t;t=null!==t.left&&t.left.max>=r.low?t.left:t.right}return null},s.prototype.findAll=function(t,r,e){return this._findAll(this.root,t,r,e)},s.prototype._findAll=function(t,r,e,n){!0===(n=n||!1)?n=this.isExact:!1===n&&(n=this.doOverlap);var l=new Array(this.length),i=0,o=new Array(this.length),a=-1,h=0;if(o[++a]=t,null===t)return null;for(;a<=h;){var u=o[a];a++,!n(u.interval,r)||null!=e&&u.d!==e||(l[i++]=u),null!==u.left&&u.left.max>=r.low&&(o[++h]=u.left),null!==u.right&&u.right.min<=r.high&&(o[++h]=u.right)}for(var f=new Array(i),s=0;s<i;s++)f[s]=l[s];return f},s.prototype.remove=function(t,r){return this._remove(this.root,t,r)},s.prototype._remove=function(t,r,e){var o=null,a=null,h=null,u=new Array(this.length),f=-1,s=new Array(this.length),v=-1;if(u[++f]=t,null===t)return null;for(;f>=0;){var c=u[f];if(u[f]=null,f--,c.interval.low===r.low&&c.interval.high===r.high&&(null==e||c.d===e)){if(h={low:c.interval.low,high:c.interval.high,d:c.d},this.length--,null===c.left)o?(o[a]=c.right,c=c.right):this.root=c.right;else if(null===c.right)o?(o[a]=c.left,c=c.left):this.root=c.left;else{var p=n(c.right);c.interval=p.top.interval,c.d=p.top.d;var g=c.left;c.left=p.top.left,c.right=p.right,p.current===p.top?c.left=g:p.current.left=g,l(p.currentToTopArr)}c&&(s[++v]=c);break}s[++v]=c,null!==c.right&&c.interval.low<r.low?(o=c,a="right",u[++f]=c.right):null!==c.left&&c.interval.low>=r.low&&(o=c,a="left",u[++f]=c.left)}for(;v>=0;){var d=i(s[v]);s[v].min=d.min,s[v].max=d.max,v--}return h},s.prototype.removeAll=function(t,r){return this._removeAll(this.root,t,r)},s.prototype._removeAll=function(t,r,e){var o=null,a=null,h=new Array(this.length),u=0,f=new Array(this.length),s=-1,v=new Array(this.length),c=-1;if(f[++s]=t,null===t)return null;for(;s>=0;){var p=f[s];if(f[s]=null,s--,p.interval.low!==r.low||p.interval.high!==r.high||null!=e&&p.d!==e)v[++c]=p,null!==p.right&&p.interval.low<r.low?(o=p,a="right",f[++s]=p.right):null!==p.left&&p.interval.low>=r.low&&(o=p,a="left",f[++s]=p.left);else{if(h[u++]={low:p.interval.low,high:p.interval.high,d:p.d},this.length--,null===p.left)o?(o[a]=p.right,p=p.right):this.root=p.right;else if(null===p.right)o?(o[a]=p.left,p=p.left):this.root=p.left;else{var g=n(p.right);p.interval=g.top.interval,p.d=g.top.d;var d=p.left;p.left=g.top.left,p.right=g.right,g.current===g.top?p.left=d:g.current.left=d,l(g.currentToTopArr)}p&&(f[++s]=p)}}for(;c>=0;){var m=i(v[c]);v[c].min=m.min,v[c].max=m.max,c--}for(var w=new Array(u),y=0;y<u;y++)w[y]=h[y];return w},s.prototype.getSortedData=function(){if(null===this.root)return[];for(var t=new Array(this.length),r=0,e=new Array(this.length),n=-1,l=this.root;null!==l||n>=0;){for(;null!==l;)e[++n]=l,l=l.left;l=e[n--],t[r++]={interval:{low:l.interval.low,high:l.interval.high},d:l.d},l=l.right}return t},s.prototype.doOverlap=function(t,r){return t.low<=r.high&&r.low<=t.high},s.prototype.isExact=function(t,r){return t.low===r.low&&t.high===r.high},s.prototype.printHtmlTree=function(){return h(this.root,this.length)};var v=s;e(0)}])}));